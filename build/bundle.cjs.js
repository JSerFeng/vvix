"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const e=e=>null==e,t=e=>null!=e,n=[];exports.activeEffect=null;let s=!1;function l(e,t={lazy:!1,active:!0}){const n=r(e,t);return n.lazy||n(),n}function r(e,t){const l=function t(...r){t.active&&!s&&(n.includes(l)||(n.push(t),exports.activeEffect=l,e(...r),n.pop(),exports.activeEffect=null))};return l.lazy=t.lazy||!1,l.active=t.active||!0,l.raw=e,l.deps=[],l.scheduler=t.scheduler||null,l}const o=(e,t)=>{const n=i.get(e);if(!n)return;const s=n.get(t);s&&s.forEach((e=>{e!==exports.activeEffect&&(e.scheduler?e.scheduler(e):e())}))},i=new WeakMap,a=(e,t)=>{if(!exports.activeEffect)return;let n=i.get(e);n||i.set(e,n=new Map);let s=n.get(t);s||n.set(t,s=new Set),s.has(exports.activeEffect)||(s.add(exports.activeEffect),exports.activeEffect.deps.push(s))},c=new WeakMap,d=new WeakMap,f={get(e,t,n){if("_mark"===t)return!0;if("_raw"===t)return e;const s=Reflect.get(e,t,n);return a(e,t),"object"==typeof s?p(s):s},set(e,t,n,s){const l=e[t],r=Reflect.set(e,t,n,s);return n!==l&&o(e,t),r},has(e,t){const n=Reflect.has(e,t);return a(e,t),n},deleteProperty(e,t){const n=Reflect.deleteProperty(e,t);return o(e,t),n}},p=e=>{if("object"!=typeof e)return e;if(e._raw)return e;let t;return(t=c.get(e))||(t=new Proxy(e,f),d.set(t,e)),t};class u{constructor(t){this._isRef=!0,e(t)?this._value=null:this._value=(e=>"object"==typeof e&&null!==e)(t)?p(t):t}get value(){return a(this,"value"),this._value}set value(e){e!==this._value&&(this._value=e,o(this,"value"))}}var h,g;exports.VNodeFlags=void 0,(h=exports.VNodeFlags||(exports.VNodeFlags={}))[h.Element=1]="Element",h[h.FC=2]="FC",h[h.Text=4]="Text",h[h.Fragment=8]="Fragment",exports.ChildrenFlags=void 0,(g=exports.ChildrenFlags||(exports.ChildrenFlags={}))[g.Multiple=1]="Multiple",g[g.Single=2]="Single",g[g.NoChildren=8]="NoChildren";const x=Symbol("Fragment");class F{constructor(e,n,s){this.data={},this._isVNode=!0,this.el=null,this._instance=null,this.type=e,"function"==typeof e?(this.flags=exports.VNodeFlags.FC,this._instance={_props:{children:[],...n},_render:null,_mounted:!1,_vnode:null,_update:null,_onMount:[],_onUnmount:[]}):this.flags="string"==typeof e?exports.VNodeFlags.Element:e===x?exports.VNodeFlags.Fragment:exports.VNodeFlags.Text,this.data=n,this.key=t(n.key)?n.key:null;Array.isArray(s)?(this.children=s.map((e=>"string"==typeof e?_(null,null,e):e)),this.childFlags=exports.ChildrenFlags.Multiple):"object"==typeof s&&null!==s?(this.children=s,this.childFlags=exports.ChildrenFlags.Single):"string"==typeof s?this.flags&exports.VNodeFlags.Text?(this.childFlags=exports.ChildrenFlags.NoChildren,this.children=s):(this.childFlags=exports.ChildrenFlags.Single,this.children=_(null,null,s)):(this.childFlags=exports.ChildrenFlags.NoChildren,this.children=null)}}function _(e,t,...n){let s=null;return 0===n.length?s=null:1===n.length?(s=n[0],"object"!=typeof s&&(s+="")):s=n,new F(e,t||{},s)}const v=(e,t,n)=>{let{children:s}=t;return void 0===s?s=[]:Array.isArray(s)||(s=[s]),_(e,{key:n,...t},...s)},m=v,y=[];let C=!1;const N=e=>{y.includes(e)||y.push(e),C||(C=!0,Promise.resolve().then(k))},k=()=>{y.forEach((e=>e())),y.length=0,C=!1},E=/\[A-Z]|^(?:value|checked|selected|muted)$/;let V=null;const w={getElement:e=>document.querySelector(e),createElement:e=>document.createElement(e),createTextNode:e=>document.createTextNode(e),appendChild:(e,t)=>e.appendChild(t),insertBefore:(e,t,n)=>e.insertBefore(t,n),removeChild:(e,t)=>e.removeChild(t),setAttribute(e,t,n){/\[A-Z]|^(?:value|checked|selected|muted)$/.test(t)?e[t]=n:"key"!==t&&"children"!==t&&e.setAttribute(t,n)},setText:(e,t)=>e.textContent=t,patchData(e,t,n,s,l){if(n!==s&&!(l&&l&exports.VNodeFlags.Element&&"children"===t))switch(t){case"style":if(n)for(const t in n)e.style[t]=n[t];if(s)for(const t in s)n&&n[t]===s[t]||(e.style[t]="");break;case"class":e.className=n;break;default:if(t.startsWith("on")){const l=t.split("on")[1].toLowerCase();n&&e.addEventListener(l,n),s&&e.removeEventListener(l,s)}else E.test(t)?e[t]=n:e.setAttribute(t,n)}}};function b(n){function s(t,r,o){if(e(t))return;const{flags:a}=t;a&exports.VNodeFlags.FC?function(e,t,n){const{type:r}=e;e._instance._update=()=>{if(e._instance._mounted){const n=e._instance._vnode,s=e._instance._render();i(s,n,t),e._instance._vnode=s}else{const l=e._instance._vnode=e._instance._render();s(l,t,n),e.el=l.el,e._instance._mounted=!0;for(const t of e._instance._onMount)t()}},V=e._instance,e._instance._render=r(e._instance._props),V=null,l((()=>{e._instance._update()}),{scheduler:N})}(t,r,o):a&exports.VNodeFlags.Element?function(e,t,l){const{data:r,childFlags:o,children:i}=e,a=e.el=n.createElement(e.type);r.ref&&(r.ref.value=a);for(const e in r)n.patchData(a,e,r[e],null,exports.VNodeFlags.Element);l?n.insertBefore(t,a,l):n.appendChild(t,a);!function(e,t,n,l){if(e&exports.ChildrenFlags.NoChildren)return;e&exports.ChildrenFlags.Single?s(t,l):e&exports.ChildrenFlags.Multiple&&function(e,t){for(const n of t)s(n,e.el)}(n,t)}(o,i,e,a)}(t,r,o):a&exports.VNodeFlags.Text?function(e,t,s){const l=n.createTextNode(e.children);e.el=l,s?n.insertBefore(t,l,s):n.appendChild(t,l)}(t,r,o):function(e,t,n){const{children:l}=e;Array.isArray(l)?(l.forEach((e=>s(e,t,n))),e.el=l[0].el):l&&(s(l,t,n),e.el=l.el)}(t,r,o)}function r(e,t){const{flags:s,children:l}=e;s&exports.VNodeFlags.Element||s&exports.VNodeFlags.Text?n.removeChild(t,e.el):s&exports.VNodeFlags.FC?o(e,t):s&exports.VNodeFlags.Fragment&&(Array.isArray(l)?l.forEach((e=>r(e,t))):l&&r(l,t))}function o(e,t){const{childFlags:n,children:s}=e,l=e.el;if(n&exports.ChildrenFlags.Multiple)for(const e of s)e.flags&exports.VNodeFlags.FC&&o(e,l);let r=e._instance._onUnmount;if(r.length)for(const e of r)e();t.removeChild(l)}function i(e,t,l){if(e&&t)if(o=t,(r=e).flags===o.flags&&r.type===o.type){const s=e.flags;s&exports.VNodeFlags.FC?function(e,t){if(e.el=t.el,e._instance=t._instance,function(e,t){const n=e._instance._props,s=t._instance._props;return delete n.children,delete s.children,((e,t)=>{if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const n in e)if(!(n in t)||e[n]!==t[n])return!1;return!0})(n,s)}(e,t))return;const n=e._instance._props,s=t._instance._props;for(const t in n)n[t]!==s[t]&&(e._instance._props[t]=n[t]);e._instance._update()}(e,t):s&exports.VNodeFlags.Text?function(e,t){const s=e.el=t.el;e.children!==t.children&&n.setText(s,e.children)}(e,t):s&exports.VNodeFlags.Element?function(e,t){const s=e.el=t.el;for(const l in e.data)n.patchData(s,l,e.data[l],t.data[l],exports.VNodeFlags.Element);for(const l in t.data)e.data[l]||n.patchData(s,l,null,t.data[l],exports.VNodeFlags.Element);a(e,t)}(e,t):function(e,t){a(e,t)}(e,t)}else!function(e,t,n){n.removeChild(t.el),s(e,n)}(e,t,l);else e?s(e,l):t&&n.removeChild(l,t.el);var r,o}function a(e,l){const{childFlags:o,children:a}=e,{childFlags:c,children:d,el:f}=l;if(o&exports.ChildrenFlags.NoChildren){if(c&exports.ChildrenFlags.Single)r(d,f);else if(c&exports.ChildrenFlags.Multiple)for(const e of d)r(e,f)}else if(o&exports.ChildrenFlags.Single){if(c&exports.ChildrenFlags.NoChildren)s(a,f);else if(c&exports.ChildrenFlags.Single)i(a,d,f);else if(c&exports.ChildrenFlags.Multiple){for(const e of d)r(e,f);s(a,f)}}else if(o&exports.ChildrenFlags.Multiple)if(c&exports.ChildrenFlags.NoChildren)for(const e of a)s(e,f);else if(c&exports.ChildrenFlags.Single){r(d,f);for(const e of a)s(e,f)}else c&exports.ChildrenFlags.Multiple&&function(e,l,o){let a=0,c=e.length-1,d=e[a],f=l.length-1,p=l[a];e:{for(;a<=c&&a<=f&&d.key===p.key;){if(i(d,p,o),a++,a>c||a>f)break e;d=e[a],p=l[a]}for(d=e[c],p=l[f];a<=c&&a<=f&&d.key===p.key;){if(i(d,p,o),c--,f--,a>c||a>f)break e;d=e[c],p=l[f]}}if(a>c&&a<=f)for(let e=a;e<=f;e++)r(l[e],o);else if(a>f){const t=f+1>=l.length?void 0:l[f+1].el;for(let n=a;n<=c;n++)s(e[n],o,t)}else{let u=!1,h=0,g=0;const x=c-a+1,F=new Array(x).fill(-1),_={};for(let t=0;t<x;t++)_[e[a+t].key]=t;for(let n=a;n<=f;n++)if(p=l[n],g<x){const s=_[p.key];t(s)?(d=e[s+a],i(d,p,o),g++,F[s]=n,s<h?u=!0:h=s):r(p,o)}else r(p,o);if(u){const t=(e=>{const t=e.length;if(0===t)return[];if(1===t)return[0];const n=new Array(t).fill(1),s=[];let l=-1;for(let s=t-1;s>=0;s--){const r=e[s];for(let o=s+1;o<t;o++)r<e[o]&&(n[s]=Math.max(n[s],1+n[o]),(-1===l||n[l]<n[s])&&(l=s))}if(-1===l)return[];for(;l<t;){const e=n[l];for(s.push(l++);n[l]!==e-1&&l<t;)l++}return s})(F);let l=t.length-1;for(let r=c;r>=a;r--){if(d=e[r],-1===F[r]){s(d,o,r+1<e.length?e[r+1].el:void 0)}if(r===t[l])l--;else{const t=r+1<e.length?e[r+1].el:void 0;n.insertBefore(o,d.el,t)}}}}}(a,d,f)}return function(e,t){const n=t.vnode;n?e?(i(e,n,t),t.vnode=e):(t.removeChild(n.el),t.vnode=null):(s(e,t),t.vnode=e)}}const M=()=>{return!!V||(e="hook must be called inside a function component",console.warn(e),!1);var e},A=b(w);exports.Fragment=x,exports.Ref=u,exports.VNode=F,exports.baseNodeOps=w,exports.checkHookAvailable=M,exports.createApp=(e,t)=>{t||(t=w);const n=b(t);return{mount(s){s?"string"!=typeof s||(s=t.getElement(s))?n(e,s):console.warn("无效的id或者class"):console.warn("请指定一个挂在节点的id或者class或者dom节点")}}},exports.createEffect=r,exports.createRenderer=b,exports.effect=l,exports.effectStack=n,exports.expose=e=>{M()&&V._props.ref&&(V._props.ref.value=e)},exports.h=_,exports.jsx=v,exports.jsxs=m,exports.markRaw=e=>(e._raw=!0,e),exports.onMounted=e=>{M()&&V._onMount.push(e)},exports.onUnmounted=e=>{M()&&V._onUnmount.push(e)},exports.pauseTracking=()=>{s=!0},exports.queueJob=N,exports.reactive=p,exports.ref=function(t){return e(t)?new u:(e=>e&&!!e._isRef)(t)?t:new u(t)},exports.render=A,exports.resetTracking=()=>{s=!1},exports.stop=e=>{e.active=!1},exports.toRaw=e=>d.get(e)||e,exports.track=a,exports.trigger=o;
