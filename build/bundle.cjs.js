Object.defineProperty(exports,"__esModule",{value:!0});const e=(e,t)=>e.flags===t.flags&&e.type===t.type,t=(e,t)=>{if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const n in e)if(!(n in t)||e[n]!==t[n])return!1;return!0},n=e=>{const t=e.length;if(0===t)return[];if(1===t)return[0];const n=new Array(t).fill(1),o=[];let r=-1;for(let o=t-1;o>=0;o--){const s=e[o];for(let l=o+1;l<t;l++){s<e[l]&&(n[o]=Math.max(n[o],1+n[l]),(-1===r||n[r]<n[o])&&(r=o))}}if(-1===r)return[];for(;r<t;){const e=n[r];for(o.push(r++);n[r]!==e-1&&r<t;)r++}return o},o=e=>Array.isArray(e),r=e=>"object"==typeof e&&null!==e,s=e=>null==e,l=e=>null!=e,i=[];exports.activeEffect=null;let a=!1;function c(e,t={lazy:!1,active:!0}){const n=d(e,t);return n.lazy||n(),n}function d(e,t){const n=function t(...o){t.active&&!a&&(i.includes(n)||(i.push(t),exports.activeEffect=n,e(...o),i.pop(),exports.activeEffect=null))};return n.lazy=t.lazy||!1,n.active=t.active||!0,n.raw=e,n.deps=[],n.scheduler=t.scheduler||null,n}const p=(e,t)=>{const n=f.get(e);if(!n)return;const o=n.get(t);o&&o.forEach((e=>{e!==exports.activeEffect&&(e.scheduler?e.scheduler(e):e())}))},f=new WeakMap,u=(e,t)=>{if(!exports.activeEffect)return;let n=f.get(e);n||f.set(e,n=new Map);let o=n.get(t);o||n.set(t,o=new Set),o.has(exports.activeEffect)||(o.add(exports.activeEffect),exports.activeEffect.deps.push(o))},h=new WeakMap,g=new WeakMap,x={get(e,t,n){if("_mark"===t)return!0;if("_raw"===t)return e;const o=Reflect.get(e,t,n);return u(e,t),r(o)&&!o._isVNode?_(o):o},set(e,t,n,o){const r=e[t],s=Reflect.set(e,t,n,o);return n!==r&&p(e,t),s},has(e,t){const n=Reflect.has(e,t);return u(e,t),n},deleteProperty(e,t){const n=Reflect.deleteProperty(e,t);return p(e,t),n}},_=e=>{if("object"!=typeof e)return e;if(e._raw)return e;let t;return(t=h.get(e))||(t=new Proxy(e,x),g.set(t,e)),t},F=e=>e&&!!e._isRef;class v{constructor(e){this._isRef=!0,s(e)?this._value=null:this._value=r(e)?_(e):e}get value(){return u(this,"value"),this._value}set value(e){e!==this._value&&(this._value=e,p(this,"value"))}}function m(e){return s(e)?new v:F(e)?e:new v(e)}var y,C;exports.VNodeFlags=void 0,(y=exports.VNodeFlags||(exports.VNodeFlags={}))[y.Element=1]="Element",y[y.FC=2]="FC",y[y.Text=4]="Text",y[y.Fragment=8]="Fragment",y[y.Portal=16]="Portal",y[y.Svg=32]="Svg",exports.ChildrenFlags=void 0,(C=exports.ChildrenFlags||(exports.ChildrenFlags={}))[C.Multiple=1]="Multiple",C[C.Single=2]="Single",C[C.NoChildren=8]="NoChildren";const k=Symbol("Fragment"),N=Symbol("Portal");class E{constructor(e,t,n,o){this.data={},this._isVNode=!0,this.el=null,this._instance=null,this.type=e,"function"==typeof e?(this.flags=exports.VNodeFlags.FC,this._instance={_props:{children:[],...t},_render:null,_mounted:!1,_vnode:null,_update:null,_onMount:[],_onUnmount:[]}):this.flags="string"==typeof e?"svg"===e?exports.VNodeFlags.Svg:exports.VNodeFlags.Element:e===k?exports.VNodeFlags.Fragment:e===N?exports.VNodeFlags.Portal:exports.VNodeFlags.Text,l(o)?this.key=o:l(t.key)?(this.key=t.key,delete t.key):this.key=null,this.data=t;Array.isArray(n)?(this.children=n.map((e=>r(e)?e:V(null,null,e+""))),this.childFlags=exports.ChildrenFlags.Multiple):r(n)?(this.children=n,this.childFlags=exports.ChildrenFlags.Single):l(n)?this.flags&exports.VNodeFlags.Text?(this.childFlags=exports.ChildrenFlags.NoChildren,this.children=n.toString()):(this.childFlags=exports.ChildrenFlags.Single,this.children=V(null,null,n.toString())):(this.childFlags=exports.ChildrenFlags.NoChildren,this.children=null)}}function V(e,t,...n){let o=null;return 0===n.length?o=null:1===n.length?(o=n[0],"object"!=typeof o&&(o+="")):o=n,new E(e,t||{},o)}const w=(e,t,n)=>{let{children:r}=t;if(o(r)){let e=!1,t=[];for(const n of r)if(o(n)){e=!0,t=n;break}if(e){const e={};for(const n of t)if(l(n.key)){if(n.key in e){console.error("[key property] can not be the same \nduplicated key: \n"+n.key);break}e[n.key]=!0}else console.error("child in an array must have a key \n");r=r.flat()}}return new E(e,t,r,n)},b=w,S=[];let M=!1;const T=e=>{S.includes(e)||S.push(e),M||(M=!0,Promise.resolve().then(A))},A=()=>{S.forEach((e=>e())),S.length=0,M=!1},P=/\[A-Z]|^(?:value|checked|selected|muted)$/;exports._currentMountingFC=null;const R={getElement:e=>document.querySelector(e),createElement:e=>document.createElement(e),createTextNode:e=>document.createTextNode(e),createComment:e=>document.createComment(e),createSvgElement:e=>document.createElementNS("http://www.w3.org/2000/svg",e),appendChild:(e,t)=>e.appendChild(t),insertBefore:(e,t,n)=>e.insertBefore(t,n),removeChild:(e,t)=>e.removeChild(t),setAttribute(e,t,n){/\[A-Z]|^(?:value|checked|selected|muted)$/.test(t)?e[t]=n:"key"!==t&&"children"!==t&&e.setAttribute(t,n)},setText:(e,t)=>e.textContent=t,patchData(e,t,n,o,r){if(n!==o&&!(r&&r&exports.VNodeFlags.Element&&"children"===t))switch(t){case"style":if(n)for(const t in n)e.style[t]=n[t];if(o)for(const t in o)n&&n[t]===o[t]||(e.style[t]="");break;case"class":e.className=n;break;default:if(t.startsWith("on")){const r=t.split("on")[1].toLowerCase();n&&e.addEventListener(r,n),o&&e.removeEventListener(r,o)}else P.test(t)?e[t]=n:e.setAttribute(t,n)}}};function j(o){function r(e,t,n,l){if(s(e))return;const{flags:i}=e;i&exports.VNodeFlags.FC?function(e,t,n,o){const{type:s}=e;e._instance._update=()=>{if(e._instance._mounted){const o=e._instance._vnode,r=e._instance._render();d(r,o,t,n,o?.el?.nextSibling),e._instance._vnode=r}else{const s=e._instance._vnode=e._instance._render();r(s,t,n,o),e.el=s.el,e._instance._mounted=!0;for(const t of e._instance._onMount)t()}},exports._currentMountingFC=e._instance,e._instance._render=s(e._instance._props),exports._currentMountingFC=null,c((()=>{e._instance._update()}),{scheduler:T})}(e,t,n,l):i&(exports.VNodeFlags.Element|exports.VNodeFlags.Svg)?function(e,t,n,s){const{data:l,childFlags:i,children:a,type:c}=e,d=e.el=n?o.createSvgElement(c):o.createElement(c);l.ref&&(l.ref.value=d);for(const e in l)o.patchData(d,e,l[e],null,exports.VNodeFlags.Element);s?o.insertBefore(t,d,s):o.appendChild(t,d);!function(e,t,n,o,s){if(e&exports.ChildrenFlags.NoChildren)return;if(e&exports.ChildrenFlags.Single)r(t,o,s);else if(e&exports.ChildrenFlags.Multiple){const e=n.el;for(const n of t)r(n,e,s)}}(i,a,e,d,n)}(e,t,n,l):i&exports.VNodeFlags.Text?function(e,t,n){const r=o.createTextNode(e.children);e.el=r,n?o.insertBefore(t,r,n):o.appendChild(t,r)}(e,t,l):i&exports.VNodeFlags.Portal?function(e){const t=e.el="string"==typeof e.key?o.getElement(e.key):e.key;r(e.children,t,!1)}(e):function(e,t,n,s){const{children:l}=e;Array.isArray(l)?l.forEach((e=>r(e,t,n,s))):l&&r(l,t,n,s);const i=o.createComment("__FRAGMENT_END__");e.el=i,s?o.insertBefore(t,i,s):o.appendChild(t,i)}(e,t,n,l)}function i(e,t){const{flags:n,children:r,el:s}=e;if(n&exports.VNodeFlags.Element||n&exports.VNodeFlags.Text)o.removeChild(t,e.el);else if(n&exports.VNodeFlags.FC)a(e,t);else if(n&exports.VNodeFlags.Fragment)Array.isArray(r)?r.forEach((e=>i(e,t))):r&&i(r,t),o.removeChild(t,s);else if(n&exports.VNodeFlags.Portal){const t=e.el;i(e.children,t)}}function a(e,t){const{childFlags:n,children:r}=e,s=e.el;if(n&exports.ChildrenFlags.Multiple)for(const e of r)e.flags&exports.VNodeFlags.FC&&a(e,s);let l=e._instance._onUnmount;if(l.length)for(const e of l)e();e._instance=null,o.removeChild(t,s)}function d(n,s,l,a,c){if(n&&s)if(e(n,s)){const e=n.flags;e&exports.VNodeFlags.FC?function(e,n){if(e.el=n.el,e._instance=n._instance,function(e,n){const o=e._instance._props,r=n._instance._props;return delete o.children,delete r.children,t(o,r)}(e,n))return;const o=e._instance._props,r=n._instance._props;for(const t in o)o[t]!==r[t]&&(e._instance._props[t]=o[t]);e._instance._update()}(n,s):e&exports.VNodeFlags.Text?function(e,t){const n=e.el=t.el;e.children!==t.children&&o.setText(n,e.children)}(n,s):e&exports.VNodeFlags.Element?function(e,t,n){const r=e.el=t.el;for(const n in e.data)o.patchData(r,n,e.data[n],t.data[n],exports.VNodeFlags.Element);for(const n in t.data)e.data[n]||o.patchData(r,n,null,t.data[n],exports.VNodeFlags.Element);p(e,t,n)}(n,s,a):e&exports.VNodeFlags.Portal?function(e,t){const n=e.el=t.el;d(e.children,t.children,n,!1)}(n,s):function(e,t,n,o){const r=e.el=t.el;p(e,t,o,n,r)}(n,s,l,a)}else!function(e,t,n,o){const s=t.el?.nextSibling;i(t,n),r(e,n,o,s)}(n,s,l,a);else n?r(n,l,a,c):s&&i(s,l)}function p(e,t,s,a,c){const{childFlags:p,children:f}=e,{childFlags:u,children:h}=t,g=a||t.el;if(p&exports.ChildrenFlags.NoChildren){if(u&exports.ChildrenFlags.Single)i(h,g);else if(u&exports.ChildrenFlags.Multiple)for(const e of h)i(e,g)}else if(p&exports.ChildrenFlags.Single){if(u&exports.ChildrenFlags.NoChildren)r(f,g,s,c);else if(u&exports.ChildrenFlags.Single)d(f,h,g,s,c);else if(u&exports.ChildrenFlags.Multiple){for(const e of h)i(e,g);r(f,g,s,c)}}else if(p&exports.ChildrenFlags.Multiple)if(u&exports.ChildrenFlags.NoChildren)for(const e of f)r(e,g,s,c);else if(u&exports.ChildrenFlags.Single){i(h,g);for(const e of f)r(e,g,s,c)}else u&exports.ChildrenFlags.Multiple&&function(e,t,s,a,c){let p=0,f=e.length-1,u=e[p],h=t.length-1,g=t[p];e:{for(;p<=f&&p<=h&&u.key===g.key;){if(d(u,g,s,a),p++,p>f||p>h)break e;u=e[p],g=t[p]}for(u=e[f],g=t[h];p<=f&&p<=h&&u.key===g.key;){if(d(u,g,s,a),f--,h--,p>f||p>h)break e;u=e[f],g=t[h]}}if(p>f&&p<=h)for(let e=p;e<=h;e++)i(t[e],s);else if(p>h){const n=h+1>=t.length?void 0:t[h+1].el;for(let t=p;t<=f;t++)r(e[t],s,a,n)}else{let x=!1,_=0,F=0;const v=f-p+1,m=new Array(v).fill(-1),y={},C={};for(let t=0;t<v;t++)y[e[p+t].key]=t;for(let n=p;n<=h;n++)if(g=t[n],C[g.key]=!0,F<v){const t=y[g.key];l(t)?(u=e[t+p],d(u,g,s,a),F++,m[t]=n,t<_?x=!0:_=t):i(g,s)}else i(g,s);if(x){const t=n(m);let l=t.length-1;for(let n=f;n>=p;n--){if(u=e[n],-1===m[n]){r(u,s,a,n+1<e.length?e[n+1].el:void 0)}if(n===t[l])l--;else{const t=n+1<e.length?e[n+1].el:void 0;o.insertBefore(s,u.el,t)}}}else for(let t=f;t>=p;t--)if(u=e[t],!C[u.key]){r(u,s,a,(t+1>=e.length?void 0:e[t+1].el)||c)}}}(f,h,g,s,c)}return function(e,t){const n=!!(e.flags&exports.VNodeFlags.Svg);d(e,t.vnode,t,n)}}const B=()=>!!exports._currentMountingFC||(_warn("hook must be called inside a function component"),!1),D=(e,t)=>{t||(t=R);const n=j(t);return{mount(o){o?"string"!=typeof o||(o=t.getElement(o))?n(e,o):console.warn("无效的id或者class"):console.warn("请指定一个挂在节点的id或者class或者dom节点")}}},O=[{id:0,title:"Better Call Saul",content:"The best TV Series EVER! Though it's a little bit  slow tempo at first. You mustn't miss it."},{id:1,title:"Breaking Bad",content:"The second best series, it's the best until I meet 《Better Call Saul》"},{id:2,title:"The Walking Dead",content:"It's interesting at first, however..."}];const U=({title:e,content:t})=>()=>b("div",{children:[w("h1",{children:e},void 0),w("p",{children:t},void 0)]},void 0),W=({msg:e})=>()=>b("h1",{children:["fail: ",e]},void 0),z=()=>{const[e,t,n]=function(){const e=m(3),t=m();let n=null;const o=()=>{n&&clearTimeout(n),e.value=1,n=setTimeout((()=>{e.value=0,t.value=O}),1e3)};return o(),[e,t,o]}();return()=>b(k,{children:[w("button",Object.assign({onClick:n},{children:"retry"}),void 0),1===e.value?"loading...":2===e.value?w(W,{msg:"oops, something wrong !"},void 0):t.value?.map((e=>w(U,{title:e.title,content:e.content},e.id)))]},void 0)},L=()=>()=>w("h1",{children:"child"},void 0);D(w((()=>()=>b("div",{children:[w(z,{},void 0),w(L,{},void 0)]},void 0)),{},void 0)).mount("#app"),exports.Fragment=k,exports.Portal=N,exports.Ref=v,exports.VNode=E,exports._err=(e,t)=>{console.error(e),console.error(t)},exports._warn=e=>{console.warn(e)},exports.baseNodeOps=R,exports.checkHookAvailable=B,exports.createApp=D,exports.createEffect=d,exports.createPortal=function(e,t){return n=>("function"==typeof e&&(e=w(e,n)),()=>w(N,{children:e},t))},exports.createRenderer=j,exports.effect=c,exports.effectStack=i,exports.expose=e=>{B()&&exports._currentMountingFC._props.ref&&(exports._currentMountingFC._props.ref.value=e)},exports.h=V,exports.isArray=o,exports.isDef=l,exports.isObject=r,exports.isRef=F,exports.isSameVNode=e,exports.isUndef=s,exports.jsx=w,exports.jsxs=b,exports.lis=n,exports.markRaw=e=>(e._raw=!0,e),exports.onMounted=e=>{B()&&exports._currentMountingFC._onMount.push(e)},exports.onUnmounted=e=>{B()&&exports._currentMountingFC._onUnmount.push(e)},exports.pauseTracking=()=>{a=!0},exports.reactive=_,exports.ref=m,exports.resetTracking=()=>{a=!1},exports.shallowEqual=t,exports.stop=e=>{e.active=!1},exports.toRaw=e=>g.get(e)||e,exports.track=u,exports.trigger=p;
